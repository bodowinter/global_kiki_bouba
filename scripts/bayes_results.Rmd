---
title: "kiki/bouba Bayesian model"
author: "Bodo Winter"
date: "8/8/2019"
output: html_document
---

## Introduction

Load packages:

```{r, message = FALSE}
library(tidyverse)
library(brms)
library(gridExtra)
```

Load ggplot2 theme:

```{r}
source('theme_timo.R')
```

Load the model:

```{r}
load('../models/kiki_mdl.RData')
load('../models/kiki_script_mdl.RData')
load('../models/kiki_field_mdl.RData')
load('../models/field_ort_mdl.RData')
load('../models/field_aud_mdl.RData')
```

Load language data for plotting:

```{r, message = FALSE}
lang_info <- read_csv('../data/language_info.csv')
field_info <- read_csv('../data/language_info_field.csv')
```

## Posterior predictive checks:

Posterior predictive checks:

```{r cache = TRUE, fig.width = 8, fig.height = 6}
pp_check(kiki_mdl, nsample = 1000)
pp_check(kiki_script_mdl, nsample = 1000)
pp_check(kiki_field_mdl, nsample = 1000)
pp_check(aud_mdl, nsample = 1000)
pp_check(ort_mdl, nsample = 1000)
```

## Summarize models:

First, overall summary:

```{r}
summary(kiki_mdl)
```

Extract the posteriors:

```{r}
web_posts <- posterior_samples(kiki_mdl)
```

Get the 95% credible interval in terms of predicted probabilities:

```{r}
plogis(mean(web_posts$b_Intercept))
plogis(quantile(web_posts$b_Intercept, 0.025))
plogis(quantile(web_posts$b_Intercept, 0.975))
```

Posterior predictive probability of the intercept being above chance (logit = 0).

```{r}
sum(web_posts$b_Intercept < 0) / nrow(web_posts)
```

Second, field model (with modality effect ignored):

```{r}
summary(kiki_field_mdl)
```

Extract the posteriors:

```{r}
field_posts <- posterior_samples(kiki_field_mdl)
```

Get the 95% credible interval in terms of predicted probabilities:

```{r}
plogis(mean(field_posts$b_Intercept))
plogis(quantile(field_posts$b_Intercept, 0.025))
plogis(quantile(field_posts$b_Intercept, 0.975))
```

Posterior predictive probability of the intercept being above chance (logit = 0).

```{r}
sum(field_posts$b_Intercept < 0) / nrow(field_posts)
```

## Separate analysis for auditory and written version of field experiment:

Separate model summaries:

```{r}
summary(aud_mdl)
summary(ort_mdl)
```

Extract posteriors:

```{r}
aud_posts <- posterior_samples(aud_mdl)
ort_posts <- posterior_samples(ort_mdl)
```

Posterior estimates of the intercepts:

```{r}
sum(aud_posts$b_Intercept < 0) / nrow(aud_posts)
sum(ort_posts$b_Intercept < 0) / nrow(ort_posts)
```

Get the 95% credible interval in terms of predicted probabilities, auditory only:

```{r}
plogis(mean(aud_posts$b_Intercept))
plogis(quantile(aud_posts$b_Intercept, 0.025))
plogis(quantile(aud_posts$b_Intercept, 0.975))
```

Get the 95% credible interval in terms of predicted probabilities, written only:

```{r}
plogis(mean(ort_posts$b_Intercept))
plogis(quantile(ort_posts$b_Intercept, 0.025))
plogis(quantile(ort_posts$b_Intercept, 0.975))
```

## Check orthography-related effects in web-based experiments:

Check script effect in web experiment:

```{r}
summary(kiki_script_mdl)
```

Get the posterior predictions:

```{r}
script_posts <- posterior_samples(kiki_script_mdl)
```

Check whether the coefficients are reliably different from 0:

```{r}
sum(script_posts$b_Scriptroman > 0) / nrow(script_posts)
```

What is the predicted increase in probability for roman script?

```{r}
# Non-roman script:

plogis(fixef(kiki_script_mdl)[1, 1])

# Roman script:

plogis(fixef(kiki_script_mdl)[1, 1] + fixef(kiki_script_mdl)[2, 1])

# Odds:

exp(fixef(kiki_script_mdl)[2, 1])
```

This completes this analysis.

